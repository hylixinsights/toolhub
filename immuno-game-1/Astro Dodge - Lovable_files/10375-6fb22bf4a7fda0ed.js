try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5ce202b9-b8cd-4bcb-9914-d8215ed89ace",e._sentryDebugIdIdentifier="sentry-dbid-5ce202b9-b8cd-4bcb-9914-d8215ed89ace")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[10375],{42083:(e,t,r)=>{r.d(t,{d:()=>o});var n=r(20097),i=r(568028),a=r(325413),l=r(375896);let o=a.forwardRef((e,t)=>{let{className:r,thumbClassName:a,size:o="default",...s}=e;return(0,n.jsx)(i.bL,{className:(0,l.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50","sm"===o&&"h-4 w-7","lg"===o&&"h-6 w-11",r),...s,ref:t,children:(0,n.jsx)(i.zi,{className:(0,l.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0 dark:data-[state=unchecked]:bg-foreground","sm"===o&&"h-3 w-3 data-[state=checked]:translate-x-3","lg"===o&&"h-5 w-5 data-[state=checked]:translate-x-5",a)})})});o.displayName=i.bL.displayName},71071:(e,t,r)=>{r.d(t,{D:()=>o});var n=r(20097),i=r(372311),a=r(17308),l=r(135345);function o(e){let{folder:t,targetVisibility:r,descendantCount:o,className:s}=e;if(t.visibility===r)return null;let d=r===l.N.Personal;return(0,n.jsx)("div",{className:s,children:(0,n.jsxs)("div",{className:"flex items-start gap-2 rounded-lg border border-warning bg-warning p-3 text-sm text-warning-foreground",children:[(0,n.jsx)(a.Y,{size:"small",className:"mt-0.5 flex-shrink-0"}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("p",{className:"font-medium",children:["Visibility will change to"," ",(0,n.jsx)(i.E,{variant:"secondary",className:"text-xs",children:d?"Personal":"Workspace"})]}),(0,n.jsx)("p",{children:d?"Only you will be able to see this folder and its projects. All other workspace members will lose access.":"All workspace members will be able to see this folder and its projects."}),o>0&&(0,n.jsx)("p",{children:1===o?"1 subfolder will also be affected.":"".concat(o," subfolders will also be affected.")})]})]})})}},124076:(e,t,r)=>{r.d(t,{Ip:()=>s,K5:()=>c,Rc:()=>o,kt:()=>d,tz:()=>l});var n=r(20097),i=r(45115);r(325413);var a=r(375896);function l(e){let{...t}=e;return(0,n.jsx)(i.bL,{"data-slot":"context-menu",...t})}function o(e){let{...t}=e;return(0,n.jsx)(i.l9,{"data-slot":"context-menu-trigger",...t})}function s(e){let{className:t,...r}=e;return(0,n.jsx)(i.ZL,{children:(0,n.jsx)(i.UC,{"data-slot":"context-menu-content",className:(0,a.cn)("max-h-(--radix-context-menu-content-available-height) origin-(--radix-context-menu-content-transform-origin) z-50 min-w-32 overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})}function d(e){let{className:t,inset:r,variant:l="default",...o}=e;return(0,n.jsx)(i.q7,{"data-slot":"context-menu-item","data-inset":r,"data-variant":l,className:(0,a.cn)("data-[variant=destructive]:*:[svg]:!text-destructive outline-hidden relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm data-[disabled]:pointer-events-none data-[inset]:pl-8 data-[variant=destructive]:text-destructive data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:focus:bg-destructive/10 data-[variant=destructive]:focus:text-destructive dark:data-[variant=destructive]:focus:bg-destructive/20 [&_svg:not([class*='size-'])]:size-4 [&_svg:not([class*='text-'])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0",t),...o})}function c(e){let{className:t,...r}=e;return(0,n.jsx)(i.wv,{"data-slot":"context-menu-separator",className:(0,a.cn)("-mx-1 my-1 h-px bg-border",t),...r})}},147682:(e,t,r)=>{r.d(t,{n:()=>n});let n=(0,r(602571).vt)(e=>({openMenuId:null,openMenuType:null,setOpenMenu:(t,r)=>e({openMenuId:t,openMenuType:r})}))},639900:(e,t,r)=>{r.d(t,{NE:()=>o,RU:()=>l,fG:()=>d,iE:()=>i,lM:()=>s,u:()=>a});var n=r(83245);function i(e,t){if(!e)return[];let r=new Map(t.map(e=>[e.id,e])),n=[],i=e;for(;i;){let e=r.get(i);if(!e)break;n.unshift(e),i=e.parent_id}return n}function a(e,t){let r=new Map(t.map(e=>[e.id,e])),n=1,i=e;for(;i;){let e=r.get(i);if(!(null==e?void 0:e.parent_id))break;n++,i=e.parent_id}return n}function l(e,t){let r=0,n=(e,i)=>{i>r&&(r=i),t.filter(t=>t.parent_id===e).forEach(e=>n(e.id,i+1))};return n(e,0),r}function o(e,t){let r=0,n=e=>{let i=t.filter(t=>t.parent_id===e);r+=i.length,i.forEach(e=>n(e.id))};return n(e),r}function s(e,t){var r;if((null==(r=e.skipped_projects)?void 0:r.length)>0){let r=e.skipped_projects.length;if(!(e.total_added>0))return n.toast.error("No projects could be ".concat(t.toLowerCase()),{description:e.skipped_projects[0].reason}),!1;n.toast.warning("".concat(t," ").concat(e.total_added," project").concat(1!==e.total_added?"s":"",", but ").concat(r," skipped"),{description:e.skipped_projects[0].reason})}return!0}function d(e,t,r){let n=new Set,i=e=>{n.add(e),r.filter(t=>t.parent_id===e).forEach(e=>i(e.id))};return i(t),n.has(e)}},673068:(e,t,r)=>{r.d(t,{X:()=>n});let n={PROJECT:"project",FOLDER:"folder",ROOT:"root",NEW_FOLDER:"new-folder",FOLDER_SORT:"folder-sort",STARRED:"starred"}},893661:(e,t,r)=>{r.d(t,{C5:()=>x,MJ:()=>g,Rr:()=>h,eI:()=>m,lR:()=>v,lV:()=>d,zB:()=>u});var n=r(20097),i=r(461364),a=r(325413),l=r(7579),o=r(468852),s=r(375896);let d=l.Op,c=a.createContext({});c.displayName="FormFieldContext";let u=e=>{let{...t}=e;return(0,n.jsx)(c.Provider,{value:{name:t.name},children:(0,n.jsx)(l.xI,{...t})})},f=()=>{let e=a.useContext(c),t=a.useContext(p),{getFieldState:r,formState:n}=(0,l.xW)(),i=r(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...i}},p=a.createContext({});p.displayName="FormItemContext";let m=a.forwardRef((e,t)=>{let{className:r,...i}=e,l=a.useId();return(0,n.jsx)(p.Provider,{value:{id:l},children:(0,n.jsx)("div",{ref:t,className:(0,s.cn)("space-y-2",r),...i})})});m.displayName="FormItem";let v=a.forwardRef((e,t)=>{let{className:r,...i}=e,{error:a,formItemId:l}=f();return(0,n.jsx)(o.Label,{ref:t,className:(0,s.cn)(a&&"",r),htmlFor:l,...i})});v.displayName="FormLabel";let g=a.forwardRef((e,t)=>{let{...r}=e,{error:a,formItemId:l,formDescriptionId:o,formMessageId:s}=f();return(0,n.jsx)(i.DX,{ref:t,id:l,"aria-describedby":a?"".concat(o," ").concat(s):"".concat(o),"aria-invalid":!!a,...r})});g.displayName="FormControl";let h=a.forwardRef((e,t)=>{let{className:r,...i}=e,{formDescriptionId:a}=f();return(0,n.jsx)("p",{ref:t,id:a,className:(0,s.cn)("text-sm text-muted-foreground",r),...i})});h.displayName="FormDescription";let x=a.forwardRef((e,t)=>{let{className:r,children:i,...a}=e,{error:l,formMessageId:o}=f(),d=l?String(null==l?void 0:l.message):i;return d?(0,n.jsx)("p",{ref:t,id:o,className:(0,s.cn)("text-xs font-medium text-destructive-foreground",r),...a,children:d}):null});x.displayName="FormMessage"},915247:(e,t,r)=>{r.d(t,{B:()=>F,v:()=>R});var n=r(20097),i=r(123723),a=r(425091),l=r(325413),o=r(83245),s=r(488381),d=r(673068),c=r(289965),u=r(207808),f=r(19733),p=r(71071),m=r(313259),v=r(480695),g=r(758742),h=r(645640),x=r(243244),b=r(378684),j=r(816402),y=r(174423),w=r(639900),I=r(135345),C=r(612466);function _(e){return!e||!(e.closest("[role='menu']")||document.querySelector("[role='dialog'][data-state='open']"))}class k extends i.cA{}k.activators=[{eventName:"onMouseDown",handler:e=>{let{nativeEvent:t}=e;return 0===t.button&&_(t.target)}}];class N extends i.IG{}N.activators=[{eventName:"onTouchStart",handler:e=>{let{nativeEvent:t}=e;return 1===t.touches.length&&_(t.target)}}];let E=(0,l.createContext)({isDragging:!1,draggedProject:null,draggedFolder:null,draggedProjectCount:0,pendingNewFolderItem:null,clearPendingNewFolderItem:()=>{}});function F(){return(0,l.useContext)(E)}function P(e){var t;if("folder_id"in e)return null!=(t=e.folder_id)?t:void 0}function R(e){var t,r;let{children:g}=e,[_,F]=(0,l.useState)(null),[R,T]=(0,l.useState)(null),[M,L]=(0,l.useState)([]),[S,X]=(0,l.useState)(null),[A,V]=(0,l.useState)(null),[z,J]=(0,l.useState)(null),G=(0,s.lR)(),{folders:U}=(0,b.ow)(G),$=(0,b._U)(G),K=(0,b.eJ)(G),W=(0,b.HP)(G),B=(0,b.gV)(G),{toggleStarAsync:q}=(0,j.u)(),H=(0,x.F)({folder:null==A?void 0:A.targetFolder,projectVisibilities:null==A?void 0:A.projectVisibilities,projectOwnerIds:null==A?void 0:A.projectOwnerIds,enabled:!!A}),Q=(null==A?void 0:A.projectIds.length)===1,Y=(0,h.G)({projectId:null!=(t=null==A?void 0:A.firstProjectId)?t:"",projectOwnerId:null!=(r=null==A?void 0:A.firstProjectOwnerId)?r:"",folder:Q?null==A?void 0:A.targetFolder:void 0,enabled:!!A&&Q}),{redundantCollaborators:Z,externalCollaborators:ee}=Y;(0,l.useEffect)(()=>{A||Y.resetSelection()},[A]);let et=(0,l.useCallback)(()=>X(null),[]),er=(0,i.FR)((0,i.MS)(k,{activationConstraint:{distance:10}}),(0,i.MS)(N,{activationConstraint:{delay:250,tolerance:5}})),en=(0,l.useCallback)(e=>{let t=e.active.data.current;if(t)if(t.type===d.X.PROJECT){var r;F(t.project),L(null!=(r=t.selectedProjectIds)?r:[t.project.id])}else t.type===d.X.FOLDER&&T(t.folder)},[]),ei=(0,l.useCallback)(async e=>{var t,r,n,i,a,l;let s=[...M];F(null),T(null),L([]);let c=e.active.data.current,u=null==(t=e.over)?void 0:t.data.current;if(c&&u)try{if(c.type===d.X.PROJECT&&u.type===d.X.FOLDER){let e=P(c.project),t=u.folderId;if(e!==t){let l=null==U?void 0:U.find(e=>e.id===t);if(l){let t=e?null==U?void 0:U.find(t=>t.id===e):void 0,r=null!=(n=c.selectedProjects)?n:[c.project],o=l.visibility===I.N.Personal?C.Lu.Draft:C.Lu.Private;if(t?t.visibility!==l.visibility:r.some(e=>!!e.visibility&&e.visibility!==o))return void V({projectIds:s,projectVisibilities:r.map(e=>{var t;return null!=(t=e.visibility)?t:void 0}),projectOwnerIds:(0,x.Q)(r),sourceFolderId:e,targetFolder:l,firstProjectId:null==(i=r[0])?void 0:i.id,firstProjectOwnerId:null==(a=r[0])?void 0:a.user_id})}e&&await K.mutateAsync({folderId:e,projectIds:s,movingToFolderId:t});let d=await $.mutateAsync({folderId:t,projectIds:s});(null==d||null==(r=d.skipped_projects)?void 0:r.length)>0?(0,w.lM)(d,"Moved"):o.toast.success("Projects moved to folder")}}if(c.type===d.X.PROJECT&&u.type===d.X.ROOT){let e=P(c.project);e&&(await K.mutateAsync({folderId:e,projectIds:s}),o.toast.success("Projects removed from folder"))}if(c.type===d.X.FOLDER&&u.type===d.X.FOLDER){let e=c.folder,t=u.folderId;if(e.id!==t&&e.parent_id!==t){if(!U)return void o.toast.error("Cannot move folder right now, please try again.");if((0,w.fG)(t,e.id,U))return void o.toast.error("Cannot move a folder into one of its subfolders");if((0,w.u)(t,U)+1+(0,w.RU)(e.id,U)>y.eE)return void o.toast.error("Cannot nest folders deeper than ".concat(y.eE," levels"));let r=U.find(e=>e.id===t);if(r&&r.visibility!==e.visibility)return void J({folder:e,targetParentId:t,targetParentVisibility:r.visibility,descendantCount:(0,w.NE)(e.id,U)});await W.mutateAsync({folderId:e.id,data:{parent_id:t}})}}if(c.type===d.X.FOLDER&&u.type===d.X.ROOT){let e=c.folder;e.parent_id&&await W.mutateAsync({folderId:e.id,data:{parent_id:""}})}if(u.type===d.X.NEW_FOLDER&&(c.type===d.X.PROJECT?X({type:"projects",ids:s,sourceFolderId:P(c.project)}):c.type===d.X.FOLDER&&X({type:"folder",id:c.folder.id})),c.type===d.X.FOLDER&&u.type===d.X.FOLDER_SORT){let e=c.folder,{parentId:t,targetIndex:r,onReorder:n}=u,i=e.parent_id||null,a=t||null;if(i===a&&n)n(e.id,r);else{if(!U)return void o.toast.error("Cannot move folder right now, please try again.");if(a&&(0,w.fG)(a,e.id,U))return void o.toast.error("Cannot move a folder into one of its subfolders");if((a?(0,w.u)(a,U)+1:0)+(0,w.RU)(e.id,U)>y.eE)return void o.toast.error("Cannot nest folders deeper than ".concat(y.eE," levels"));if(a){let t=U.find(e=>e.id===a);if(t&&t.visibility!==e.visibility)return void J({folder:e,targetParentId:a,targetParentVisibility:t.visibility,descendantCount:(0,w.NE)(e.id,U),sortData:{targetIndex:r}})}let t=null===a?"":a;await W.mutateAsync({folderId:e.id,data:{parent_id:t}});let n=[...U.filter(t=>(t.parent_id||null)===a&&t.id!==e.id)];n.splice(r,0,e),B.mutate({folderIds:n.map(e=>e.id),parentId:a})}}if(c.type===d.X.PROJECT&&u.type===d.X.STARRED){let e=(null!=(l=c.selectedProjects)?l:[c.project]).filter(e=>!e.is_starred);e.length>0&&(await Promise.all(e.map(e=>q(e.id,!1,e))),o.toast.success(1===e.length?"Project starred":"".concat(e.length," projects starred")))}}catch(e){console.error("DnD drop handler error:",e)}},[M,U,$,K,W,B,q]),ea=(0,l.useCallback)(()=>{F(null),T(null),L([])},[]),el=(0,l.useCallback)(async()=>{if(A)try{var e;A.sourceFolderId&&await K.mutateAsync({folderId:A.sourceFolderId,projectIds:A.projectIds,movingToFolderId:A.targetFolder.id});let t=await $.mutateAsync({folderId:A.targetFolder.id,projectIds:A.projectIds});if(1===A.projectIds.length&&A.firstProjectId)try{await Y.removeUnkeptCollaborators(A.firstProjectId)}catch(e){}if((null==t||null==(e=t.skipped_projects)?void 0:e.length)>0)(0,w.lM)(t,"Moved");else{let e=A.projectIds.length;o.toast.success("Moved ".concat(e," project").concat(1!==e?"s":""," to folder"))}V(null)}catch(e){}},[A,$,K,Y]),eo=(0,l.useCallback)(async()=>{if(z)try{var e;let t=null!=(e=z.targetParentId)?e:"";if(await W.mutateAsync({folderId:z.folder.id,data:{parent_id:t}}),z.sortData&&z.targetParentId&&U){let e=[...U.filter(e=>(e.parent_id||null)===z.targetParentId&&e.id!==z.folder.id)];e.splice(z.sortData.targetIndex,0,z.folder),B.mutate({folderIds:e.map(e=>e.id),parentId:z.targetParentId})}J(null)}catch(e){}},[z,W,U,B]),es=(0,l.useMemo)(()=>({isDragging:!!_||!!R,draggedProject:_,draggedFolder:R,draggedProjectCount:M.length,pendingNewFolderItem:S,clearPendingNewFolderItem:et}),[_,R,M.length,S,et]);return(0,n.jsx)(i.Mp,{sensors:er,collisionDetection:i.TT,onDragStart:en,onDragEnd:ei,onDragCancel:ea,children:(0,n.jsxs)(E.Provider,{value:es,children:[g,(0,n.jsxs)(i.Hd,{modifiers:[a.jw],dropAnimation:null,children:[_&&(0,n.jsx)(D,{project:_,count:M.length}),R&&(0,n.jsx)(O,{folder:R})]}),(0,n.jsx)(v.lG,{open:!!A,onOpenChange:e=>!e&&V(null),children:(0,n.jsxs)(v.Cf,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(v.c7,{children:[(0,n.jsxs)(v.L3,{children:["Move ",(null==A?void 0:A.projectIds.length)===1?"project":"".concat(null==A?void 0:A.projectIds.length," projects")," ","to “",null==A?void 0:A.targetFolder.name,"”"]}),(0,n.jsxs)(v.rr,{children:["This will change who can access the ",(null==A?void 0:A.projectIds.length)===1?"project":"projects","."]})]}),A&&(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)(f.J,{folderVisibility:A.targetFolder.visibility,projectVisibilities:A.projectVisibilities}),H&&(0,n.jsx)(c.$,{diff:H,folderVisibility:A.targetFolder.visibility}),Q&&(Z.length>0||ee.length>0)&&(0,n.jsx)(u.M,{redundantCollaborators:Z,externalCollaborators:ee,selectedIdsToKeep:Y.collaboratorIdsToKeep,onSelectionChange:Y.setCollaboratorIdsToKeep,folderVisibility:A.targetFolder.visibility})]}),(0,n.jsxs)(v.Es,{children:[(0,n.jsx)(m.$,{variant:"outline",onClick:()=>V(null),children:"Cancel"}),(0,n.jsx)(m.$,{onClick:el,disabled:Q&&Y.isLoading,loading:$.isPending||K.isPending||Y.isBatchRemoving,loadingText:"Moving...",children:"Confirm"})]})]})}),(0,n.jsx)(v.lG,{open:!!z,onOpenChange:e=>!e&&J(null),children:(0,n.jsxs)(v.Cf,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(v.c7,{children:[(0,n.jsx)(v.L3,{children:"Move folder"}),(0,n.jsxs)(v.rr,{children:["Moving “",(0,n.jsx)("span",{translate:"no",children:null==z?void 0:z.folder.name}),"” will change its visibility."]})]}),z&&(0,n.jsx)(p.D,{folder:z.folder,targetVisibility:z.targetParentVisibility,descendantCount:z.descendantCount}),(0,n.jsxs)(v.Es,{children:[(0,n.jsx)(m.$,{variant:"outline",onClick:()=>J(null),children:"Cancel"}),(0,n.jsx)(m.$,{onClick:eo,loading:W.isPending,loadingText:"Moving...",children:"Confirm"})]})]})})]})})}function D(e){let{project:t,count:r}=e,i="latest_screenshot_url"in t?t.latest_screenshot_url:void 0,a="display_name"in t?t.display_name:void 0;return(0,n.jsxs)("div",{className:"pointer-events-none relative flex max-w-[200px] items-center gap-2 rounded-lg border bg-background px-3 py-2 shadow-lg",children:[(0,n.jsx)("div",{className:"h-8 w-8 flex-shrink-0 rounded bg-muted-hover bg-cover bg-center",style:{backgroundImage:i?"url(".concat(i,")"):void 0}}),(0,n.jsx)("span",{className:"truncate text-sm font-medium",translate:"no",children:r>1?"".concat(r," projects"):a||t.name}),r>1&&(0,n.jsx)("div",{className:"absolute -right-2 -top-2 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-xs font-medium text-primary-foreground",children:r})]})}function O(e){let{folder:t}=e;return(0,n.jsxs)("div",{className:"pointer-events-none flex max-w-[200px] items-center gap-2 rounded-lg border bg-background px-3 py-2 shadow-lg",children:[(0,n.jsx)(g.s,{size:"small",style:t.color?{color:t.color}:void 0}),(0,n.jsx)("span",{className:"truncate text-sm font-medium",translate:"no",children:t.name})]})}E.displayName="ProjectDndContext"}}]);