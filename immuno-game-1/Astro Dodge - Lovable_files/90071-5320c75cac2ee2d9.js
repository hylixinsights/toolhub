try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4baffb68-9eaf-47ab-acfe-b11e588d1d0c",e._sentryDebugIdIdentifier="sentry-dbid-4baffb68-9eaf-47ab-acfe-b11e588d1d0c")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90071],{106080:(e,t,r)=>{r.d(t,{bT:()=>d,bY:()=>x,x_:()=>o});var a=r(20097),n=r(325413),l=r(373924),s=r(108980);let i={GAP_SCALE_FACTOR:.002,MIN_GAP_WIDTH:2,MIN_INDICATOR_WIDTH:7,PROGRESS_BAR_HEIGHT:11,FALLBACK_MIN_WIDTH_PERCENTAGE:2},c=["bg-blue-800","bg-blue-600","bg-blue-400","bg-blue-200","bg-blue-50"],o=(e,t)=>{if(!e)return"bg-muted-foreground";if("granted"===e)return"bg-brand-twilight-primary";let r=t.filter(e=>"granted"!==e.name).findIndex(t=>t.name===e);return -1===r?"bg-muted-foreground":c[Math.min(r,c.length-1)]},d=e=>{switch(e){case"daily":return"Daily credits used first";case"rollover":return"Using rollover credits";case"billing":return"Using monthly credits";case"topup":return"Using topup credits";case"granted":return"Using bonus credits";case null:return"You are out of credits"}},u={granted:"Bonus",billing:"Monthly",rollover:"Rollover",topup:"Top-up",daily:"Daily"},m=e=>u[e],x=e=>{let{progressData:t,onClick:r}=e,c=(0,n.useRef)(null),[d,u]=(0,n.useState)(0);(0,n.useLayoutEffect)(()=>{let e=()=>{c.current&&u(c.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let x=Math.max(i.MIN_GAP_WIDTH,d*i.GAP_SCALE_FACTOR),p=i.MIN_INDICATOR_WIDTH,g=(0,n.useMemo)(()=>t.hasCredits?t.sources.map((e,r)=>{let a=Math.max(t.totalAllocation>0?e.remaining/t.totalAllocation*100:0,d>0?p/d*100:i.FALLBACK_MIN_WIDTH_PERCENTAGE),n=r===t.sources.length-1,l=o(e.name,t.sources);return{...e,widthPercentage:a,isFirst:0===r,isLast:n,colorClass:l}}):[],[t.hasCredits,t.sources,t.totalAllocation,d,p]),f=(0,n.useMemo)(()=>{if(!t.hasCredits||0===g.length)return[];let e=d>0?x/d*100:.4,r=Math.max(0,g.length-1)*e,a=g.reduce((e,t)=>e+t.widthPercentage,0)+r,n=a>100?100/a:1,l=e*n,s=0;return g.map(e=>{let t=e.widthPercentage*n,r=s;return s+=t+(e.isLast?0:l),{...e,widthPercentage:t,leftOffset:r}})},[t.hasCredits,g,d,x]);return t.hasCredits?(0,a.jsx)("div",{className:"flex w-full items-center gap-2 ".concat(r?"cursor-pointer transition-all duration-150 ease-in-out hover:opacity-80":""),onClick:r,children:(0,a.jsx)("div",{ref:c,className:"relative flex-1 overflow-hidden rounded-lg bg-muted-active",style:{height:"".concat(i.PROGRESS_BAR_HEIGHT,"px")},children:f.map(e=>(0,a.jsxs)(l.m_,{delayDuration:0,children:[(0,a.jsx)(l.k$,{asChild:!0,children:(0,a.jsx)("div",{className:"absolute h-full cursor-pointer ".concat(e.colorClass," transition-all ").concat(e.isFirst?"rounded-bl-lg rounded-tl-lg":""," ").concat(e.isLast?"rounded-br-lg rounded-tr-lg":""),style:{left:"".concat(e.leftOffset,"%"),width:"".concat(e.widthPercentage,"%")}})}),(0,a.jsx)(l.ZI,{className:"z-[10002] border border-gray-200 bg-white shadow-lg",children:(0,a.jsx)("div",{className:"justify-center text-xs font-normal leading-none text-black",children:["granted","topup"].includes(e.name)?"".concat((0,s.Q)(e.remaining)," ").concat(m(e.name)," credits"):"".concat((0,s.Q)(e.remaining),"/").concat((0,s.Q)(e.limit)," ").concat(m(e.name)," credits")})})]},e.name))})}):(0,a.jsx)("div",{className:"flex w-full items-center gap-2 ".concat(r?"cursor-pointer transition-all duration-150 ease-in-out hover:opacity-80":""),onClick:r,children:(0,a.jsx)("div",{className:"relative h-2.5 flex-1 overflow-hidden rounded-lg bg-muted-active"})})}},141742:(e,t,r)=>{r.d(t,{A:()=>s});var a,n=r(325413);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}let s=function(e){return n.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e),a||(a=n.createElement("path",{fill:"currentColor",d:"M19.91 8.732q0-.156-.021-.309l-5.991 3.37-.13.08a2.25 2.25 0 0 0-1.018 1.881v6.903q.194-.069.375-.172l5.66-3.269a2.25 2.25 0 0 0 1.125-1.948zm-6.785-5.216a2.25 2.25 0 0 0-2.25 0l-5.66 3.268a2.3 2.3 0 0 0-.413.306l6.096 3.429a2.25 2.25 0 0 0 2.206 0l6.093-3.429a2.3 2.3 0 0 0-.412-.306zM4.09 15.268a2.25 2.25 0 0 0 1.125 1.948l5.66 3.269q.18.104.375.17v-6.9a2.25 2.25 0 0 0-1.132-1.953L4.11 8.422q-.02.153-.02.31zm17.32 0a3.75 3.75 0 0 1-1.875 3.248l-5.66 3.268a3.75 3.75 0 0 1-3.75 0l-5.66-3.268a3.75 3.75 0 0 1-1.875-3.248V8.732a3.75 3.75 0 0 1 1.875-3.247l5.66-3.269a3.75 3.75 0 0 1 3.75 0l5.66 3.269a3.75 3.75 0 0 1 1.875 3.247z"})))}},170332:(e,t,r)=>{r.d(t,{U:()=>s});var a=r(20097),n=r(433080),l=r(375896);let s=e=>{let{plan:t,className:r}=e,{isInactivePlan:s,isFreePlan:i}=(0,n.cb)(t),c=(0,n._R)(t);return(0,a.jsx)("span",{className:(0,l.cn)("rounded-full px-2 py-px text-center text-xs font-medium uppercase transition-colors duration-150 ease-in-out md:text-[10px]",i||s?"bg-muted-active text-muted-foreground":"bg-brand-twilight-primary text-brand-twilight-primary-foreground",r),translate:"no",children:c})}},221141:(e,t,r)=>{r.d(t,{N:()=>n});var a=r(241447);let n=(0,r(780493).w)(a.A,"PersonPlusIcon")},241447:(e,t,r)=>{r.d(t,{A:()=>s});var a,n=r(325413);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}let s=function(e){return n.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e),a||(a=n.createElement("path",{fill:"currentColor",d:"M18.25 22v-2.25H16a.75.75 0 0 1 0-1.5h2.25V16a.75.75 0 0 1 1.5 0v2.25H22a.75.75 0 0 1 0 1.5h-2.25V22a.75.75 0 0 1-1.5 0M12 12.25c1.46 0 2.828.404 3.995 1.107a.75.75 0 1 1-.775 1.286 6.254 6.254 0 0 0-9.219 3.595.67.67 0 0 0 .163.666c.182.2.486.346.837.346h5a.75.75 0 0 1 0 1.5H7a2.64 2.64 0 0 1-1.944-.833 2.16 2.16 0 0 1-.495-2.102 7.75 7.75 0 0 1 7.439-5.565M14.25 7a2.25 2.25 0 1 0-4.5 0 2.25 2.25 0 0 0 4.5 0m1.5 0a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0"})))}},248503:(e,t,r)=>{r.d(t,{t:()=>n});var a=r(481141);let n=(0,r(780493).w)(a.A,"BoltFilledIcon")},261492:(e,t,r)=>{r.d(t,{m:()=>P});var a=r(20097),n=r(506286),l=r(470800),s=r(325413),i=r(488381),c=r(313259),o=r(515169),d=r(803099),u=r(518925),m=r(816232),x=r(433080),p=r(375896),g=r(282330),f=r(904879);let h=e=>{let{hideForFreePlan:t=!1}=e,r=(0,i.j4)(e=>e.currentWorkspace),{isLowOnCredits:n,creditsRemaining:h}=(0,d.S)(r),v=(0,o.s)(),b=(0,g.X)(),{mustHidePayments:w}=(0,u._)(),{isFreePlan:j}=(0,x.cb)(null==r?void 0:r.plan),y=t&&j;return((0,s.useEffect)(()=>{n&&!y&&l.Ay.capture(m.ZK.WORKSPACE_MODAL.PROMPT_SHOWN,{credits_remaining:h,current_plan:null==r?void 0:r.plan})},[n,y,h,null==r?void 0:r.plan]),!n||y||w)?null:(0,a.jsx)("div",{"data-nudge":!0,className:"relative -mt-6 flex w-full flex-col rounded-b-xl border border-t-0 border-border bg-background md:rounded-b-lg",children:(0,a.jsxs)("div",{className:"flex h-full w-full items-center justify-between gap-2 pb-2 pl-2 pr-1 pt-8",children:[(0,a.jsx)("div",{className:"relative flex flex-1 items-start gap-2 p-1 pl-0",children:(0,a.jsx)("div",{className:(0,p.cn)("ml-0 flex flex-1 gap-1 pl-0.5"),children:(0,a.jsx)("span",{className:"font-normal text-foreground md:text-sm",children:"Low on credits?"})})}),(0,a.jsx)("div",{className:"flex items-start gap-1 pr-1",children:(0,a.jsx)("div",{className:"flex h-full flex-col items-center justify-start gap-1",children:(0,a.jsx)(f.Q,{showTooltip:!v,tooltipContent:"Ask the workspace owner to top up",children:(0,a.jsx)(c.$,{intent:"affirmative",size:"sm",onClick:()=>{l.Ay.capture(m.ZK.WORKSPACE_MODAL.BUTTON_CLICKED,{credits_remaining:h,current_plan:null==r?void 0:r.plan}),b()},disabled:!v,children:(0,a.jsx)("span",{className:"text-sm md:text-xs",children:"Add credits"})})})})})]})})};var v=r(544276),b=r(933310),w=r(866497),j=r(198623),y=r(50319),N=r(213978),k=r(373924),C=r(987530),_=r(465338),E=r(539104),A=r(108980),I=r(106080);let M=e=>{let{workspace:t,canManagePlan:r,membership:n}=e,l=(0,C.D)(t),{openSettings:s}=(0,j.t)(),{userMonthlyUsage:i,maxUserMonthlyUsage:c,hasCreditLimit:o}=(0,_.$)(t),{isBizPlan:d,isFreePlan:m,isLitePlan:g}=(0,x.cb)(t.plan),{mustHidePayments:f,mustUseNativePaywall:h}=(0,u._)(),M=(0,I.x_)(l.currentlyConsuming,l.sources),S=(0,v.GP)((0,b.w)((0,w.P)(new Date,1)),"dd MMM");return(0,a.jsxs)("div",{className:"z-10 flex flex-col gap-2.5 rounded-xl bg-muted p-4 md:rounded-lg md:p-3",children:[(0,a.jsxs)("div",{className:(0,p.cn)("flex items-center justify-between",{"cursor-pointer transition-all duration-150 ease-in-out hover:opacity-80":r&&!h}),onClick:r&&!h?()=>s("billing"):void 0,children:[(0,a.jsx)("p",{className:"text-base font-medium text-foreground md:text-sm",children:"Credits"}),(0,a.jsxs)("div",{className:"flex items-center gap-px",children:[(0,a.jsx)("p",{className:(0,p.cn)("text-base font-normal md:text-sm",0===l.totalRemaining&&r?"text-foreground":"text-muted-foreground"),children:0===l.totalRemaining&&r&&!h?f?"Manage":"Upgrade":0===l.totalRemaining?"0 left":"".concat((0,A.Q)(l.totalRemaining)," left")}),r&&!h&&(0,a.jsx)(y.v,{size:"small",className:(0,p.cn)(0===l.totalRemaining?"text-foreground":"text-muted-foreground")})]})]}),(0,a.jsx)(I.bY,{progressData:l,onClick:r&&!h?()=>s("billing"):void 0}),(l.currentlyConsuming||0===l.totalRemaining)&&!m&&(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(M)}),(0,a.jsx)("p",{className:"text-base text-muted-foreground md:text-sm",children:(0,I.bT)(l.currentlyConsuming)})]}),(m||g)&&(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full bg-muted-foreground"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:l.totalCreditsUsedInBillingPeriod>=E.le?"Free credits reset on ".concat(S):"Daily credits reset at midnight UTC"})]}),d&&(0,a.jsx)("div",{className:"flex flex-col gap-2.5",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-base font-medium text-foreground md:text-sm",children:"Personal usage"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("p",{className:"text-base font-normal text-muted-foreground md:text-sm",children:[(0,A.Q)(i),o&&" / ".concat((0,A.Q)(c))]}),(null==n?void 0:n.role)!=="owner"&&o&&(0,a.jsxs)(k.m_,{children:[(0,a.jsx)(k.k$,{asChild:!0,children:(0,a.jsx)("div",{children:(0,a.jsx)(N.e,{size:"small",className:"cursor-pointer text-muted-foreground"})})}),(0,a.jsx)(k.ZI,{children:(0,a.jsx)("p",{children:"Ask your workspace admin to increase the limit"})})]})]})]})})]})};var S=r(637093),O=r(640715);let P=e=>{let{workspace:t,membership:r,className:l,hideNudgeForFreePlan:s}=e,i=(0,S.WW)();if("inactive"===t.plan)return null;let{permitted:c}=(0,n.J)(O.eZ.ManageWorkspaceBilling),o=(null==r?void 0:r.role)==="owner"||(null==r?void 0:r.role)==="admin",{isBizPlan:d,isEnterprisePlan:u}=(0,x.cb)(t.plan);return u?null:!d||o||i?(0,a.jsxs)("div",{className:(0,p.cn)("flex flex-col",l),children:[(0,a.jsx)(M,{workspace:t,canManagePlan:c,membership:r}),(0,a.jsx)(h,{hideForFreePlan:s})]}):null}},264378:(e,t,r)=>{r.d(t,{l:()=>l});var a=r(325413),n=r(533264);let l=()=>({upload:(0,a.useCallback)(async e=>{let{fileName:t,file:r,options:a,continueOnError:l=!0}=e;return(0,n.QM)(t,r,a,l)},[]),download:(0,a.useCallback)(async e=>(0,n.PE)(e),[])})},312410:(e,t,r)=>{r.d(t,{A:()=>s});var a,n=r(325413);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}let s=function(e){return n.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e),a||(a=n.createElement("path",{fill:"currentColor",d:"M20.25 12a8.22 8.22 0 0 0-1.911-5.28L6.72 18.34A8.25 8.25 0 0 0 20.25 12m-16.5 0c0 2.008.718 3.848 1.91 5.278L17.278 5.66A8.25 8.25 0 0 0 3.75 12m18 0c0 5.385-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12 6.615 2.25 12 2.25s9.75 4.365 9.75 9.75"})))}},434699:(e,t,r)=>{r.d(t,{A:()=>s});var a,n=r(325413);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}let s=function(e){return n.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e),a||(a=n.createElement("path",{fill:"currentColor",d:"M7.25 12c0-.773.043-1.526.122-2.25H4.063a8.25 8.25 0 0 0 0 4.5h3.31A21 21 0 0 1 7.25 12m1.879 3.75c.186.87.434 1.65.727 2.31.337.757.719 1.322 1.104 1.689.381.363.732.501 1.04.501s.659-.138 1.04-.501c.385-.367.767-.932 1.104-1.69.293-.66.54-1.44.727-2.309zm-4.477 0a8.27 8.27 0 0 0 4.371 3.943 9 9 0 0 1-.537-1.024c-.375-.845-.676-1.833-.887-2.919zm11.75 0c-.212 1.086-.513 2.074-.888 2.919a9 9 0 0 1-.538 1.024 8.27 8.27 0 0 0 4.372-3.943zM14.975 4.306q.293.476.538 1.025c.375.845.676 1.833.887 2.919h2.947a8.28 8.28 0 0 0-4.372-3.944M12 3.75c-.308 0-.659.138-1.04.501-.385.367-.767.933-1.104 1.69-.293.66-.54 1.44-.727 2.309h5.742a12 12 0 0 0-.727-2.31c-.337-.756-.719-1.322-1.104-1.689-.381-.363-.732-.501-1.04-.501m-2.977.556a8.28 8.28 0 0 0-4.37 3.944h2.946c.21-1.086.512-2.074.887-2.919q.245-.55.537-1.025M8.75 12c0 .782.047 1.536.132 2.25h6.236c.085-.714.132-1.468.132-2.25s-.047-1.536-.132-2.25H8.882A19 19 0 0 0 8.75 12m8 0c0 .773-.043 1.526-.122 2.25h3.308a8.25 8.25 0 0 0 0-4.5h-3.308c.08.724.122 1.477.122 2.25m5 0c0 5.385-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12 6.615 2.25 12 2.25s9.75 4.365 9.75 9.75"})))}},481141:(e,t,r)=>{r.d(t,{A:()=>s});var a,n=r(325413);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}let s=function(e){return n.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e),a||(a=n.createElement("path",{fill:"currentColor",d:"M11.546 1.27c.73-.877 2.204-.373 2.204.809v7.17h5.787a1.25 1.25 0 0 1 1.022 1.97l-8.036 11.42c-.703.999-2.273.502-2.273-.718V14.75H4.463a1.25 1.25 0 0 1-1.022-1.97l8.037-11.42z"})))}},515169:(e,t,r)=>{r.d(t,{s:()=>l});var a=r(506286),n=r(640715);let l=()=>{let{permitted:e}=(0,a.J)(n.eZ.ManageWorkspaceBilling);return e}},525835:(e,t,r)=>{r.d(t,{t:()=>n});var a=r(312410);let n=(0,r(780493).w)(a.A,"BanIcon")},533264:(e,t,r)=>{r.d(t,{F$:()=>l,PE:()=>i,QM:()=>s,QN:()=>c});var a=r(926206),n=r(96324);let l=e=>e.replace(/[#?&=%+@:;[\]'"<>{}|\\^`\s]/g,"_"),s=async function(e,t,l){var s,i;let c=!(arguments.length>3)||void 0===arguments[3]||arguments[3],o=null!=(s=null==l?void 0:l.maxFileSize)?s:3145728,d=null!=(i=null==l?void 0:l.maxDimension)?i:2e3,u=t;if(t.type.startsWith("image/"))if(["image/svg+xml","image/gif","image/x-icon","image/vnd.microsoft.icon"].includes(t.type))u=t;else{let e=new Image,a=URL.createObjectURL(t);try{if(await new Promise(t=>{e.onload=()=>{URL.revokeObjectURL(a),t()},e.onerror=()=>{URL.revokeObjectURL(a),t()},e.src=a}),t.size>o||Math.max(e.width,e.height)>d)try{let{default:e}=await r.e(5976).then(r.bind(r,905976));u=await e(t,{maxSizeMB:o/1024/1024,maxWidthOrHeight:Math.min(d,1920),useWebWorker:!0})}catch(e){if(n.logging.error("Error compressing image:",{error:e}),!c)throw e}}catch(e){n.logging.warn("Could not process image for compression, using original",{error:e}),u=t}}let m={file_name:e,content_type:u.type,status:"uploading"},x=await (0,a.Pg)().post("/files/generate-upload-url",m),p=await fetch(x.url,{method:"PUT",body:u,headers:{"Content-Type":u.type}});if(!p.ok){let t=Error("Upload failed with status ".concat(p.status));if(n.logging.error("File upload failed:",{fileName:e,status:p.status}),!c)throw t}},i=async e=>(0,a.Pg)().post("/files/generate-download-url",e),c=async e=>(0,a.Pg)().post("/files/generate-public-url",e)},555284:(e,t,r)=>{r.d(t,{m:()=>n});var a=r(603989);let n=(0,r(780493).w)(a.A,"DotGrid2x3Icon")},603989:(e,t,r)=>{r.d(t,{A:()=>s});var a,n=r(325413);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}let s=function(e){return n.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e),a||(a=n.createElement("path",{fill:"currentColor",d:"M10.75 19a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0m6 0a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0m-6-7a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0m6 0a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0m-6-7a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0m6 0a1.75 1.75 0 1 1-3.5 0 1.75 1.75 0 0 1 3.5 0"})))}},642820:(e,t,r)=>{r.d(t,{r:()=>s});var a=r(488381),n=r(506286),l=r(640715);let s=()=>{let e=(0,a.j4)(e=>e.currentWorkspace),{permissions:t}=(0,n.S)(),r=t.includes(l.eZ.AddWorkspaceAdmins),s=l.ss.some(e=>t.includes(e));return!!e&&s&&(!1!==e.editor_can_invite||r)}},779801:(e,t,r)=>{r.d(t,{w:()=>b});var a=r(20097),n=r(134472),l=r(715429),s=r(325413),i=r(83245),c=r(21696),o=r(902357),d=r(515845),u=r(373924),m=r(264378),x=r(876721),p=r(926206),g=r(533264),f=r(630298),h=r(375896);let v=["image/png","image/jpeg","image/jpg","image/webp"],b=e=>{let{workspace:t,className:r}=e,{authUser:b}=(0,c.Z2)(),w=(0,p.Pg)(),{upload:j}=(0,m.l)(),y=(0,x._)(),N=(0,n.jE)(),k=(0,s.useRef)(null),C=()=>{k.current&&(k.current.value="")},{mutateAsync:_,isPending:E}=(0,l.n)({mutationFn:async e=>{let{file:r}=e;if(!b)throw Error("You must be logged in to upload files");let a=(0,g.F$)(r.name);await j({fileName:a,file:r,options:{maxFileSize:10240,maxDimension:200},continueOnError:!1});let{url:n}=await (0,g.QN)({dir_name:b.uid,file_name:a});return await w.put("/user/workspaces/".concat(t.id),{image_url:n})},onSuccess:()=>{i.toast.success("Updated workspace avatar",{description:"Succesfully uploaded new workspace avatar"}),N.invalidateQueries({queryKey:f.workspaceKeys.all}),C()},onError:()=>{i.toast.error("Failed to update workspace avatar",{description:"Please try again"}),C()}}),A=async e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&await _({file:r})};return(0,a.jsxs)(u.m_,{children:[(0,a.jsx)(u.k$,{asChild:!0,children:(0,a.jsxs)("button",{type:"button",disabled:E,onClick:()=>{var e;null==(e=k.current)||e.click()},className:(0,h.cn)("absolute inset-px flex items-center justify-center rounded-[8px] bg-black/60 transition-opacity duration-200",E?"opacity-100":"opacity-0 hover:opacity-100","cursor-pointer disabled:cursor-default",r),children:[(0,a.jsx)("input",{type:"file",className:"hidden",accept:v.join(","),onChange:A,disabled:E,ref:k}),E?(0,a.jsx)(o.y,{size:"small",className:"text-white"}):(0,a.jsx)(d.r,{size:"small",className:"text-white"})]})}),!y&&(0,a.jsx)(u.ZI,{side:"right",children:"Upload a new workspace avatar"})]})}},811578:(e,t,r)=>{r.d(t,{Ms:()=>h,Wu:()=>J,UC:()=>u,b4:()=>G,b5:()=>K,B:()=>y});var a=r(20097),n=r(412753),l=r(843883),s=r(779801),i=r(876721),c=r(433080),o=r(375896),d=r(640715);let u=e=>{let{workspace:t,memberCount:r}=e,u=(0,i._)();return(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsxs)("div",{className:(0,o.cn)("relative",u?"h-12 w-12":"h-10 w-10"),children:[(0,a.jsx)(n.z,{workspace:t,className:u?"h-12 w-12":"h-10 w-10"}),(0,a.jsx)(l.E,{permission:d.eZ.EditWorkspaceSettings,children:(0,a.jsx)(s.w,{workspace:t})})]}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:(0,o.cn)("text-base font-medium md:text-sm"),children:t.name}),(0,a.jsxs)("p",{className:(0,o.cn)("text-sm text-muted-foreground md:text-xs"),children:[(0,c._R)(t.plan)," Plan",r>0&&(0,a.jsxs)(a.Fragment,{children:[" ","â€¢ ",r," ",1===r?"member":"members"]})]})]})]})};var m=r(198623),x=r(313259),p=r(390613),g=r(221141),f=r(642820);let h=e=>{let{onClose:t}=e,r=(0,i._)(),{openSettings:n}=(0,m.t)(),l=(0,f.r)();return(0,a.jsxs)("div",{className:(0,o.cn)("flex flex-wrap",r?"gap-2":"mt-2 gap-1.5"),children:[(0,a.jsxs)(x.$,{variant:"flat",intent:"secondary",size:r?"md":"sm",onClick:()=>{t(),n("workspace")},className:(0,o.cn)(r?"flex-1 justify-center gap-2 text-base":"h-7 justify-start gap-1.5 px-3 text-xs"),children:[(0,a.jsx)(p.D,{size:r?"default":"small"}),(0,a.jsx)("span",{children:"Settings"})]}),l&&(0,a.jsxs)(x.$,{variant:"flat",intent:"secondary",size:r?"md":"sm",onClick:()=>{t(),n({tab:"people",queryParams:{invite:"true"}})},className:(0,o.cn)(r?"flex-1 justify-center gap-2 text-base":"h-7 justify-start gap-1.5 px-3 text-xs"),children:[(0,a.jsx)(g.N,{size:r?"default":"small"}),(0,a.jsx)("span",{children:r?"Invite":"Invite members"})]})]})};var v=r(470800),b=r(248503),w=r(518925),j=r(816232);let y=e=>{let{onClose:t,className:r}=e,n=(0,i._)(),{mustHidePayments:l}=(0,w._)(),{openSettings:s}=(0,m.t)();return l?null:(0,a.jsxs)("div",{className:(0,o.cn)("flex w-full items-center justify-between rounded-lg bg-muted p-3 text-foreground md:rounded-xl",r),children:[(0,a.jsxs)("span",{className:(0,o.cn)("flex items-center",n?"gap-2 text-base":"gap-1 text-sm"),children:[(0,a.jsx)(b.t,{size:n?"default":"small"}),"Turn Pro"]}),(0,a.jsx)(x.$,{size:n?"md":"sm",intent:"brand-twilight",onClick:()=>{t(),v.Ay.capture(j.lY.UPGRADE.BUTTON_CLICKED.ACCOUNT_DROPDOWN,{context:j.lY.UPGRADE.CONTEXT.BILLING}),s("billing")},children:"Upgrade"})]})};var N=r(123723),k=r(425091),C=r(924711),_=r(400282),E=r(325413),A=r(82904),I=r(388952),M=r(555284),S=r(536079),O=r(170332);let P=e=>{let{workspace:t,onSelect:r,selected:l,className:s,showDragHandle:i=!1}=e;return(0,a.jsxs)(A._2,{onClick:()=>r(),className:(0,o.cn)("group hover:bg-muted-active focus:bg-muted-active",s),children:[(0,a.jsxs)("div",{className:"relative flex h-6 w-6 items-center justify-center",children:[(0,a.jsx)(n.z,{workspace:t,className:(0,o.cn)(i&&"group-hover:opacity-0")}),i&&(0,a.jsx)(M.m,{size:"small",className:"absolute text-muted-foreground opacity-0 group-hover:opacity-100"})]}),(0,a.jsx)("p",{className:"min-w-0 truncate text-sm",translate:"no",children:t.name}),t.reauth&&(0,a.jsx)(S.X,{size:"small"}),t.plan&&(0,a.jsx)(O.U,{plan:t.plan}),l&&(0,a.jsx)(I.S,{size:"small",className:"ml-auto"})]})};var R=r(902357),T=r(633750),D=r(745784),z=r(999305),L=r(317525),U=r(191115);function W(e){let{pamWorkspaces:t,currentWorkspaceId:r,workspaces:a,onWorkspaceSelect:n}=e,l=(0,_.useRouter)(),[s,i]=(0,E.useState)(null),c=(0,L.JG)();return{handleEndSession:(0,E.useCallback)(e=>{let s=null==t?void 0:t.find(t=>t.pam_session.id===e),o=(null==s?void 0:s.workspace.id)===r;i(e),c.mutate({sessionId:e},{onSuccess:()=>{if(i(null),o){let e=a[0];e?n(e):l.push("/")}},onError:()=>{i(null)}})},[t,r,a,c,n,l]),endingSessionId:s}}let F=e=>{let{workspace:t,onSelect:r,selected:l}=e;return(0,a.jsxs)("button",{onClick:r,className:(0,o.cn)("flex items-center justify-start gap-3 rounded-lg py-2 text-left transition-colors"),children:[(0,a.jsx)(n.z,{workspace:t,className:"h-8 w-8"}),(0,a.jsx)("p",{className:"min-w-0 truncate text-base",children:t.name}),t.plan&&(0,a.jsx)(O.U,{plan:t.plan}),l&&(0,a.jsx)(I.S,{className:"text-accent-foreground"})]})},B=e=>{let{pamAccess:t,onSelect:r,selected:l,onEndSession:s,isEndingSession:i}=e,c=new Date(t.pam_session.expires_at),d=(0,U.Zn)(c,{daysThreshold:7});return(0,a.jsx)("div",{className:"group",children:(0,a.jsxs)("button",{onClick:r,className:(0,o.cn)("flex w-full items-center justify-start gap-3 rounded-lg px-2 py-2 text-left transition-colors hover:bg-muted"),children:[(0,a.jsx)(n.z,{workspace:t.workspace,className:"h-8 w-8 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col",children:[(0,a.jsx)("p",{className:"truncate text-sm",children:t.workspace.name}),(0,a.jsxs)("p",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,a.jsx)(T.O,{size:"xsmall"}),(0,a.jsxs)("span",{children:["Expires ",d]})]})]}),l&&(0,a.jsx)(I.S,{className:"flex-shrink-0 text-accent-foreground group-hover:hidden"}),(0,a.jsx)(x.$,{variant:"ghost",size:"xs",iconOnly:!0,onClick:e=>{e.stopPropagation(),s(t.pam_session.id)},disabled:i,className:"hidden flex-shrink-0 group-hover:flex",title:"End session",children:i?(0,a.jsx)(R.y,{size:"small"}):(0,a.jsx)(D.u,{size:"small"})})]})})},H=e=>{let{workspace:t,isSelected:r,canDrag:n,onSelect:l,isDragging:s}=e,{attributes:i,listeners:c,setNodeRef:o,transform:d,transition:u}=(0,C.gl)({id:t.id,disabled:!n}),m={transform:d?"translate3d(".concat(d.x,"px, ").concat(d.y,"px, 0)"):void 0,transition:u,zIndex:s?10:void 0,position:s?"relative":void 0};return(0,a.jsx)("div",{ref:o,style:m,className:s?"rounded-lg bg-popover shadow-lg":void 0,...i,...c,children:(0,a.jsx)(P,{workspace:t,onSelect:l,selected:r,className:"px-2",showDragHandle:n})})},G=e=>{let{workspaces:t,pamWorkspaces:r,currentWorkspace:n,onWorkspaceSelect:l,onDraggingChange:s}=e,[i,c]=(0,E.useState)(t),[o,d]=(0,E.useState)(null),[u,m]=(0,E.useState)(!1),x=(0,E.useRef)(null),p=(0,E.useRef)(i),g=(0,E.useRef)(null),f=(0,E.useRef)(0),h=(0,E.useRef)(0),v=(0,E.useRef)(null),b=(0,L.pC)(),w=(0,z.y)(x,{deps:[i],initialValue:!0}),{handleEndSession:j,endingSessionId:y}=W({pamWorkspaces:r,currentWorkspaceId:n.id,workspaces:t,onWorkspaceSelect:l}),_=(0,N.FR)((0,N.MS)(N.cA,{activationConstraint:{distance:5}}),(0,N.MS)(N.IG,{activationConstraint:{delay:200,tolerance:5}})),A=(0,E.useCallback)(()=>{let e=x.current;if(!e)return;let t=e.getBoundingClientRect(),r=f.current,a=h.current,n=Math.round(e.scrollTop),l=r-t.top,s=t.bottom-r;l>=0&&l<30&&!(n<=0)?e.scrollTop=Math.max(0,e.scrollTop-6):s>=0&&s<30&&!(n>=a)&&(e.scrollTop=Math.min(a,e.scrollTop+6)),g.current=requestAnimationFrame(A)},[]),I=(0,E.useCallback)(e=>{f.current=e.clientY},[]),M=(0,E.useCallback)(()=>{let e=x.current;e&&(h.current=Math.floor(e.scrollHeight-e.clientHeight)),document.addEventListener("pointermove",I),g.current=requestAnimationFrame(A)},[I,A]),S=(0,E.useCallback)(()=>{document.removeEventListener("pointermove",I),g.current&&(cancelAnimationFrame(g.current),g.current=null)},[I]);(0,E.useEffect)(()=>()=>{S(),v.current&&clearTimeout(v.current)},[S]),(0,E.useEffect)(()=>{c(t),p.current=t},[t]);let O=(0,E.useCallback)(e=>{v.current&&(clearTimeout(v.current),v.current=null),d(e.active.id),m(!0),null==s||s(!0),M()},[s,M]),P=(0,E.useCallback)(e=>{let{active:t,over:r}=e;d(null),S();let a=()=>{v.current=setTimeout(()=>{m(!1),null==s||s(!1)},50)};if(r&&t.id!==r.id){let e=i.findIndex(e=>e.id===t.id),n=i.findIndex(e=>e.id===r.id);if(-1===e||-1===n)return void a();let l=(0,C.be)(i,e,n);c(l),p.current=l,b.mutate({workspaceIds:l.map(e=>e.id)})}a()},[i,s,b,S]),R=(0,E.useCallback)(()=>{d(null),S(),v.current=setTimeout(()=>{m(!1),null==s||s(!1)},50)},[s,S]),T=(0,E.useCallback)(e=>{u||l(e)},[u,l]);if(0===t.length&&(!r||0===r.length))return null;let D=i.length>1;return(0,a.jsxs)("div",{className:"flex flex-col",children:[r&&r.length>0&&(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{className:"px-2 py-1 text-xs text-muted-foreground",children:"Temporary access"}),(0,a.jsx)("div",{className:"flex flex-col",children:r.map(e=>(0,a.jsx)(B,{pamAccess:e,onSelect:()=>l(e.workspace),selected:e.workspace.id===n.id,onEndSession:j,isEndingSession:y===e.pam_session.id},e.workspace.id))})]}),t.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"px-2 py-1 text-xs text-muted-foreground",children:"All workspaces"}),(0,a.jsx)(N.Mp,{sensors:_,collisionDetection:N.fp,onDragStart:O,onDragEnd:P,onDragCancel:R,modifiers:[k.FN],autoScroll:!1,children:(0,a.jsx)(C.gB,{items:i.map(e=>e.id),strategy:C._G,children:(0,a.jsx)("div",{ref:x,className:"flex max-h-[220px] flex-col overflow-y-auto",style:i.length>5&&w?{maskImage:"linear-gradient(to bottom, black 0%, black calc(100% - 1.5rem), transparent 100%)",WebkitMaskImage:"linear-gradient(to bottom, black 0%, black calc(100% - 1.5rem), transparent 100%)"}:void 0,children:i.map(e=>(0,a.jsx)(H,{workspace:e,isSelected:e.id===n.id,canDrag:D,onSelect:()=>T(e),isDragging:o===e.id},e.id))})})})]})]})},K=e=>{let{workspaces:t,pamWorkspaces:r,currentWorkspace:n,onWorkspaceSelect:l}=e,{handleEndSession:s,endingSessionId:i}=W({pamWorkspaces:r,currentWorkspaceId:n.id,workspaces:t,onWorkspaceSelect:l});return 0!==t.length||r&&0!==r.length?(0,a.jsxs)("div",{className:"flex flex-col",children:[r&&r.length>0&&(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{className:"mb-2 text-base text-muted-foreground",children:"Temporary access"}),(0,a.jsx)("div",{className:"flex flex-col",children:r.map(e=>(0,a.jsx)(B,{pamAccess:e,onSelect:()=>l(e.workspace),selected:e.workspace.id===n.id,onEndSession:s,isEndingSession:i===e.pam_session.id},e.workspace.id))})]}),t.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"mb-2 text-base text-muted-foreground",children:"All workspaces"}),(0,a.jsx)("div",{className:"flex max-h-[250px] flex-col overflow-y-auto",children:t.map(e=>(0,a.jsx)(F,{workspace:e,onSelect:()=>l(e),selected:e.id===n.id},e.id))})]})]}):null};var Q=r(752712),Z=r(21696),$=r(365533),q=r(558926),Y=r(940994),V=r(628801),X=r(973368);let J=e=>{let{onClose:t,onCreateWorkspace:r}=e,{authUser:n}=(0,Z.Z2)(),l=(0,Q.sf)(),s=(0,E.useMemo)(()=>{if(!n)return!1;let e=new Set;n.email&&e.add(n.email.toLowerCase());let t=V.auth.currentUser;return(null==t?void 0:t.providerData)&&t.providerData.forEach(t=>{t.email&&e.add(t.email.toLowerCase())}),Array.from(e).some(e=>!(0,X.a)(e))},[n]),i=(0,$.v)();return(0,a.jsxs)("div",{className:"flex flex-col gap-1 md:gap-0",children:[(0,a.jsxs)("button",{onClick:()=>{t(),r()},className:"flex items-center gap-3 rounded-lg py-1.5 text-left text-base transition-colors active:bg-muted md:rounded-md md:px-2 md:text-sm md:hover:bg-muted-active",children:[(0,a.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-muted md:h-[26px] md:w-[26px] md:rounded-[8px]",children:(0,a.jsx)(q.c,{className:"md:h-4 md:w-4"})}),(0,a.jsx)("span",{children:"Create new workspace"})]}),s&&(0,a.jsxs)("button",{onClick:()=>{l.capture(j.nA.FIND_WORKSPACES.BUTTON_CLICKED),t(),i()},className:"flex items-center gap-3 rounded-lg py-1.5 text-left text-base transition-colors active:bg-muted md:rounded-md md:px-2 md:text-sm md:hover:bg-muted-active",children:[(0,a.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-muted md:h-[26px] md:w-[26px] md:rounded-[8px]",children:(0,a.jsx)(Y.a,{className:"md:h-4 md:w-4"})}),(0,a.jsx)("span",{children:"Find workspaces"})]})]})}},887509:(e,t,r)=>{r.d(t,{X:()=>n});var a=r(141742);let n=(0,r(780493).w)(a.A,"CubeIcon")},940994:(e,t,r)=>{r.d(t,{a:()=>n});var a=r(434699);let n=(0,r(780493).w)(a.A,"WebIcon")},999305:(e,t,r)=>{r.d(t,{y:()=>n});var a=r(325413);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{deps:r=[],initialValue:n=!1}=t,[l,s]=(0,a.useState)(n);return(0,a.useEffect)(()=>{let t=e.current;if(!t)return;let r=document.createElement("div");r.style.height="1px",r.style.width="100%",r.style.flexShrink="0",r.setAttribute("aria-hidden","true"),t.appendChild(r);let a=new IntersectionObserver(e=>{let r=e[0];r&&s(t.scrollHeight>t.clientHeight&&!r.isIntersecting)},{root:t,threshold:0});a.observe(r);let n=new ResizeObserver(()=>{a.unobserve(r),a.observe(r)});return n.observe(t),()=>{a.disconnect(),n.disconnect(),r.remove()}},[e,...r]),l}}}]);